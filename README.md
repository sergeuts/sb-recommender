# sb-recommender
 Example of recommendery system using python surprise library.
 
 Пример построения обучающейся рекомендательной системы.
 Используемая библиотека: surprise.readthedocs.io
 Применяемый алгоритм: SVD (Singular value decomposition)
 Язык программирования: Python 3.8
 
 
    Требования к системе описаны по адресу 
    https://www.kaggle.com/c/skillbox-recommender-system/overview/description
    
    Датасеты здесь: https://www.kaggle.com/c/skillbox-recommender-system/data
    
    Для построения рекомендательной системы выбрана библиотека scikit-surprise 1.1.1. (surprise.readthedocs.io)
    Датасет данной библиотеки используют таблицу рейтингов из 3-х колонок user-item-rating.
    Для подготовки этих данных используется файл transactions.csv 
    Для расчета предсказаний выбран алгоритм cингулярного разложения SVD (Singular value decomposition)
    для экономии времени при повторных расчетах реализован механизм кеширования.
    После первоначального обучения алгоритма его расчетные данные записываются на диск (методом класса dump из этой же библиотеки).
    Повторный перерасчет алгоритма происходит если не найден его дамп или если расчетные данные устарели (при сравнении времени файла
     с временем файла транзакций). При расчете прогноза на больших входных данных (например по всем пользователям) используется 
     буферизованный вывод в файл. По умолчанию размер буфера установлен для расчета 1000 пользователей (всего в датасете 100 000 пользователей). 
     Из дополнительных возможностей в тех. задании реализованы следующие функции:
    - По идентификатору пользователя выдавать набор из K наиболее релевантных для него товаров.
    - По массиву идентификаторов пользователей выдавать массив наборов из K наиболее релевантных для них товаров.
        При вызове функции predict() можно можно передавать id пользователей как строкой, так и списком.
        Например, predict(usr='7', k=10), predict(usr='10 22 42', k=15), predict(usr=['13', '22', '42'], k=4)
        В зависимости от типа параметра и количества пользователей система, вернет либо обычный одномерный список,
        рекомендуемых товаров, либо вложенный список для нескольких пользователей вида [['user_id', ['id1','id2'...]]]:
        [['13',['46', '117', '169', '264']],
         ['22',['695', '738', '1729', '1835']],
         ['42',['196', '377', '432', '1096']]]
        Если функцию predict() запустить без параметров, то она произведёт расчёт по всем пользователям и результаты
        запишет в файл submit.csv (в рабочем каталоге) в формате:
            user_id - уникальный идентификатор покупателя
            product_id - идентификаторы товаров через пробел в порядке убывания "уверенности модели"
    
    - Добавить свежие данные о транзакциях.
    - Обучить рекомендательную систему заново.
        Обновление данных происходит автоматически при (пере-)запуске системы в процедуре prepare_model().
        Обновление запуститься, если дата и/или время файла транзакций превышает соответствующие данные
        файла сводного рейтинга rank.scv и файла кеша обученной модели algo.dmp.
        Обновление запуститься также при отсутствии этих файлов.
    - Система уведомлений о состоянии алгоритма расчета и выполнении отдельных этапов. Уведомления можно отключать  .
    - Автоматическое возобновления прерванных длительных расчетов с позиции последнего сохранения буфера.
